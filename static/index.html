<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LunaGuna - מעקב גונות במחזור החודשי</title>
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
    <style>
        :root {
            --primary-color: #9C27B0;
            --border-radius: 8px;
        }

        body {
            font-family: system-ui, -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            direction: rtl;
        }

        .container {
            max-width: 800px;
            margin: 0 auto;
            background-color: white;
            padding: 20px;
            border-radius: var(--border-radius);
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        .logo {
            width: 200px;
            height: auto;
            margin: 0 auto 2rem;
            display: block;
        }

        .info-section {
            background-color: #F3E5F5;
            padding: 2rem;
            border-radius: var(--border-radius);
            margin-bottom: 2rem;
        }

        .info-section p {
            line-height: 1.6;
            margin-bottom: 1rem;
        }

        .guna-info-card {
            padding: 1.5rem;
            border-radius: var(--border-radius);
            margin-bottom: 1rem;
        }

        .tab-button {
            padding: 0.75rem 1.5rem;
            font-size: 1rem;
            border: none;
            cursor: pointer;
            transition: background-color 0.2s ease;
            border-radius: var(--border-radius);
            margin: 0 0.25rem;
        }

        .tab-button.active {
            background-color: var(--primary-color);
            color: white;
        }

        .input-field {
            padding: 0.75rem;
            border: 2px solid #e2e8f0;
            border-radius: var(--border-radius);
            width: 100%;
            max-width: 200px;
            margin-bottom: 1rem;
        }

        .guna-card {
            padding: 1.5rem;
            border-radius: var(--border-radius);
            margin-bottom: 1.5rem;
        }

        .guna-card.satva {
            background-color: #ffffff;
            color: #1a202c;
            border: 2px solid #e2e8f0;
        }

        .guna-card.rajas {
            background-color: #FED7D7;
            color: #742A2A;
            border: 2px solid #FC8181;
        }

        .guna-card.tamas {
            background-color: #2D3748;
            color: #ffffff;
            border: 2px solid #1A202C;
        }

        .calendar-button {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.5rem 1rem;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            transition: background-color 0.2s ease;
        }

        .calendar-button:hover {
            background-color: #7B1FA2;
        }

        .alert {
            background-color: #FFF3CD;
            border: 1px solid #FFEEBA;
            padding: 1rem;
            border-radius: var(--border-radius);
            margin-top: 1.5rem;
        }

        .calendar-modal {
            position: fixed;
            inset: 0;
            background-color: rgba(0, 0, 0, 0.5);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 50;
        }

        .calendar-modal-content {
            background-color: white;
            padding: 1.5rem;
            border-radius: var(--border-radius);
            max-width: 24rem;
            width: 90%;
        }

        .calendar-choice-button {
            width: 100%;
            padding: 0.75rem;
            margin: 0.5rem 0;
            border-radius: var(--border-radius);
            border: none;
            color: white;
            cursor: pointer;
            transition: background-color 0.2s ease;
        }

        @media (max-width: 640px) {
            .container {
                padding: 1rem;
            }
            
            .tab-button {
                width: 100%;
                margin-bottom: 0.5rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Logo -->
        <svg class="logo" viewBox="0 0 200 100">
            <circle cx="50" cy="50" r="35" fill="#E1BEE7" stroke="#9C27B0" strokeWidth="2"/>
            <path d="M60 50 Q80 20 100 50 T140 50" 
                  fill="none" 
                  stroke="#9C27B0" 
                  strokeWidth="3" 
                  strokeLinecap="round"/>
            <g fill="#9C27B0">
                <circle cx="85" cy="30" r="2"/>
                <circle cx="120" cy="40" r="2"/>
                <circle cx="100" cy="25" r="2"/>
            </g>
            <text x="100" y="85" 
                  fontFamily="Arial" 
                  fontSize="24" 
                  fill="#9C27B0" 
                  fontWeight="bold"
                  textAnchor="middle">
                LunaGuna
            </text>
        </svg>

        <!-- Info Section -->
        <div class="info-section">
            <h2 class="text-2xl font-bold mb-4 text-purple-800">על הגונות והמחזור החודשי</h2>
            
            <div class="space-y-4">
                <p>
                    לפי הפילוסופיה ההודית העתיקה, כל היבט בחיים מושפע משלוש איכויות (גונות) בסיסיות:
                    סאטווה (טוהר והרמוניה), רג׳אס (תנועה ואנרגיה) וטאמאס (כבדות ויציבות).
                </p>
                
                <p>
                    המחזור החודשי הנשי מהווה ביטוי מושלם לריקוד העדין בין שלוש הגונות הללו:
                </p>

                <div class="grid gap-4 mt-4">
                    <div class="p-4 bg-white rounded border-2 border-gray-200">
                        <h3 class="font-bold mb-2">סאטווה - ימי הווסת (ימים 1-5)</h3>
                        <p>תקופה של התחדשות, התכנסות פנימה וחיבור לאינטואיציה. זמן אידיאלי למדיטציה והתבוננות פנימית.</p>
                    </div>

                    <div class="p-4 bg-red-50 rounded border-2 border-red-200">
                        <h3 class="font-bold mb-2">רג׳אס - ימי הפוריות (ימים 6-16)</h3>
                        <p>תקופה של אנרגיה גבוהה, יצירתיות ופעילות. זמן מצוין ליוזמות חדשות ופעילות חברתית.</p>
                    </div>

                    <div class="p-4 bg-gray-100 rounded border-2 border-gray-300">
                        <h3 class="font-bold mb-2">טאמאס - ימי טרום הווסת (ימים 17-28)</h3>
                        <p>תקופה של האטה, עיבוד רגשי והתכוננות להתחדשות. זמן לארגון, סדר והתבוננות.</p>
                    </div>
                </div>

                <p class="mt-4">
                    הכרת הגונות והשפעתן על המחזור החודשי מאפשרת לנו לחיות בהרמוניה עם המחזוריות הטבעית של גופנו, 
                    לתכנן פעילויות בהתאם לאנרגיות המשתנות, ולהפוך את המחזור החודשי ממשהו שצריך "להתמודד" איתו 
                    לכלי עוצמתי של צמיחה והתפתחות.
                </p>
            </div>
        </div>
<!-- Tabs -->
        <div class="tabs flex justify-center gap-2 mb-6">
            <button onclick="setMode('daily')" class="tab-button" id="dailyTab">בדיקת גונה יומית</button>
            <button onclick="setMode('monthly')" class="tab-button" id="monthlyTab">תכנון חודשי</button>
        </div>

        <!-- Daily Mode -->
        <div id="dailyMode" class="mode-content">
            <h2 class="text-xl font-bold mb-4">בדיקת גונה יומית</h2>
            <input type="number" min="1" max="28" placeholder="יום במחזור (1-28)" class="input-field" id="cycleDayInput">
            <div id="dailyResult"></div>
        </div>

        <!-- Monthly Mode -->
        <div id="monthlyMode" class="mode-content" style="display: none;">
            <h2 class="text-xl font-bold mb-4">תכנון חודשי</h2>
            <input type="date" class="input-field" id="startDateInput">
            <input type="number" value="28" min="21" max="35" class="input-field" id="cycleLengthInput" placeholder="אורך מחזור">
            <button onclick="calculateMonthly()" class="calendar-button">חשבי תחזית</button>
            <div id="monthlyResult"></div>
        </div>

        <!-- Alert -->
        <div class="alert">
            <h3 class="font-bold mb-2">הערה חשובה</h3>
            <p>המידע מבוסס על מחזור ממוצע. זכרי שכל אישה חווה את המחזור באופן שונה, 
               והתזמונים יכולים להשתנות. הקשיבי לגוף שלך והתאימי את הפעילויות בהתאם.</p>
        </div>
    </div>

    <script>
        const gunaDefinitions = {
            satva: {
                name: 'סאטווה (Satva)',
                description: 'ימי הווסת - התכנסות, רוחניות, חלימה, התמסרות והרפייה',
                recommendations: [
                    'זמן טוב למדיטציה והתבוננות פנימית',
                    'מנוחה והתחדשות',
                    'הימנעות ממאמץ פיזי מוגזם'
                ],
                daysRange: [1, 5],
                cssClass: 'satva'
            },
            rajas: {
                name: 'רג׳אס (Rajas)',
                description: 'ימי טרום הביוץ והביוץ - אנרגטיות, תקשורתיות, חשק מיני, תנועה',
                recommendations: [
                    'זמן מצוין לפגישות ואירועים חברתיים',
                    'מתאים לפעילות גופנית אינטנסיבית',
                    'תקופה טובה ליוזמות חדשות'
                ],
                daysRange: [6, 16],
                cssClass: 'rajas'
            },
            tamas: {
                name: 'טאמאס (Tamas)',
                description: 'ימי טרום הווסת - עייפות, כובד, רגישות בגוף ובנפש, האטה ועיכול',
                recommendations: [
                    'התמקדות במשימות שגרתיות ומוכרות',
                    'הקדשת זמן לארגון וסדר',
                    'הימנעות מקבלת החלטות משמעותיות'
                ],
                daysRange: [17, 28],
                cssClass: 'tamas'
            }
        };

        function setMode(mode) {
            document.getElementById('dailyMode').style.display = mode === 'daily' ? 'block' : 'none';
            document.getElementById('monthlyMode').style.display = mode === 'monthly' ? 'block' : 'none';
            document.getElementById('dailyTab').classList.toggle('active', mode === 'daily');
            document.getElementById('monthlyTab').classList.toggle('active', mode === 'monthly');
        }

        function getDayGuna(day) {
            const numDay = parseInt(day);
            for (const [type, guna] of Object.entries(gunaDefinitions)) {
                if (numDay >= guna.daysRange[0] && numDay <= guna.daysRange[1]) {
                    return { type, ...guna };
                }
            }
            return null;
        }

        document.getElementById('cycleDayInput').addEventListener('input', function(e) {
            const day = e.target.value;
            const resultDiv = document.getElementById('dailyResult');
            
            if (day >= 1 && day <= 28) {
                const guna = getDayGuna(day);
                if (guna) {
                    resultDiv.innerHTML = `
                        <div class="guna-card ${guna.cssClass}">
                            <h3 class="text-xl font-bold mb-4">${guna.name}</h3>
                            <p class="mb-4">${guna.description}</p>
                            <div class="recommendations">
                                <strong>המלצות:</strong>
                                <ul class="list-disc list-inside mt-2">
                                    ${guna.recommendations.map(rec => `<li>${rec}</li>`).join('')}
                                </ul>
                            </div>
                        </div>
                    `;
                }
            } else {
                resultDiv.innerHTML = '';
            }
        });

        function formatDate(date) {
            return date.toLocaleDateString('he-IL');
        }

        function addToCalendar(guna, dateStart, dateEnd) {
            const start = new Date(dateStart);
            const end = new Date(dateEnd);
            
            // Format dates for Google Calendar
            const formatGoogleDate = (date) => {
                return date.toISOString().replace(/[:-]/g, '').split('.')[0] + 'Z';
            };

            // Format dates for ICS file
            const formatICSDate = (date) => {
                return date.toISOString().replace(/[-:]/g, '').split('.')[0] + 'Z';
            };

            const event = {
                title: `גונה: ${guna.name}`,
                description: `${guna.description}\n\nהמלצות:\n${guna.recommendations.join('\n')}`,
                startDate: formatGoogleDate(start),
                endDate: formatGoogleDate(end)
            };

            // Create Google Calendar URL
            const googleUrl = `https://calendar.google.com/calendar/render?action=TEMPLATE&text=${encodeURIComponent(event.title)}&details=${encodeURIComponent(event.description)}&dates=${event.startDate}/${event.endDate}`;

            // Create ICS content for Apple Calendar
            const icsContent = `BEGIN:VCALENDAR
VERSION:2.0
BEGIN:VEVENT
SUMMARY:${event.title}
DESCRIPTION:${event.description.replace(/\n/g, '\\n')}
DTSTART:${formatICSDate(start)}
DTEND:${formatICSDate(end)}
END:VEVENT
END:VCALENDAR`;

            // Create and show calendar choice modal
            const modalHtml = `
                <div class="calendar-modal" onclick="this.remove()">
                    <div class="calendar-modal-content" onclick="event.stopPropagation()">
                        <h3 class="text-lg font-bold mb-4">בחרי יומן</h3>
                        <div class="space-y-3">
                            <button onclick="window.open('${googleUrl}', '_blank')" 
                                    class="calendar-choice-button bg-blue-500 hover:bg-blue-600">
                                הוסיפי ליומן Google
                            </button>
                            <button onclick="downloadICS('${btoa(icsContent)}')" 
                                    class="calendar-choice-button bg-gray-800 hover:bg-gray-700">
                                הוסיפי ליומן iPhone/Apple
                            </button>
                        </div>
                    </div>
                </div>
            `;

            document.body.insertAdjacentHTML('beforeend', modalHtml);
        }

        function downloadICS(content) {
            const decoded = atob(content);
            const blob = new Blob([decoded], { type: 'text/calendar;charset=utf-8' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = 'luna-guna-event.ics';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
            document.querySelector('.calendar-modal').remove();
        }

        function calculateMonthly() {
            const startDate = new Date(document.getElementById('startDateInput').value);
            const cycleLength = parseInt(document.getElementById('cycleLengthInput').value);
            const resultDiv = document.getElementById('monthlyResult');
            
            if (!startDate || isNaN(startDate)) {
                alert('נא להזין תאריך תחילת מחזור');
                return;
            }

            let html = '<div class="space-y-6">';
            
            for (const [type, guna] of Object.entries(gunaDefinitions)) {
                const phaseStart = new Date(startDate);
                phaseStart.setDate(startDate.getDate() + guna.daysRange[0] - 1);
                
                const phaseEnd = new Date(startDate);
                phaseEnd.setDate(startDate.getDate() + guna.daysRange[1] - 1);

                html += `
                    <div class="guna-card ${guna.cssClass}">
                        <div class="flex justify-between items-start mb-4">
                            <h3 class="text-xl font-bold">${guna.name}</h3>
                            <button onclick="addToCalendar(
                                ${JSON.stringify(guna)},
                                '${phaseStart.toISOString()}',
                                '${phaseEnd.toISOString()}'
                            )" class="calendar-button">
                                <svg class="w-4 h-4" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <rect x="3" y="4" width="18" height="18" rx="2" ry="2"/>
                                    <line x1="16" y1="2" x2="16" y2="6"/>
                                    <line x1="8" y1="2" x2="8" y2="6"/>
                                    <line x1="3" y1="10" x2="21" y2="10"/>
                                </svg>
                                הוסיפי ליומן
                            </button>
                        </div>
                        <p class="mb-2">${formatDate(phaseStart)} - ${formatDate(phaseEnd)}</p>
                        <p class="mb-4">${guna.description}</p>
                        <div>
                            <strong>המלצות:</strong>
                            <ul class="list-disc list-inside mt-2">
                                ${guna.recommendations.map(rec => `<li>${rec}</li>`).join('')}
                            </ul>
                        </div>
                    </div>
                `;
            }

            html += '</div>';
            resultDiv.innerHTML = html;
        }

        // Set initial mode
        setMode('daily');
    </script>
</body>
</html>
